---
tags: []
aliases: 
data: "`2024-08-31 20:05`"
---
- ## DEF
	- applicabile anche a grafi con costi negativi ma senza cicli negativi.
		- basato su programmazione dinamica
			- e tutti i sotto-problemi sono i [[Cammini minimi]] per ogni coppia di nodi su un sotto-grafo.
	- identifichiamo $D_{xy}^k$ come la _distanza minima dal nodo_ _x_ a _y_ con l'ipotesi che i nodi intermedi appartengano solo all'insieme $\{1,...,k\}$
	- la soluzione è $D_{xy}^n$ per ogni coppia di nodi.
	- per rappresentare i sotto-problemi utilizziamo un'array di matrici.
	- ### casi:
		- $$D_{xy}^{0}=\begin {cases} D_{xx}=0 \\ ((x,y)\in E) \Rightarrow  (D_{xy}=w(x,y))\\ ((x,y)\notin E) \Rightarrow  (D_{xy}=\infty)\end {cases}$$
			- Precondizione x$\ne$y
	- ### Casi generali:
		- 1) non passo per un nodo intermedio _k_, la distanza è dunque: $D_{xy}^{k-1}$
		- 2) uso il nodo _k_, ciò implica passarci una volta sola perché è richiesto il cammino minimo: $D_{xk}^{k-1}+D_{ky}^{k-1}$ 
			- il _k-1_ non esclude l'utilizzo effettivo del nodo k ma garantisce di evitare il passaggio ripetuto su uno stesso nodo.
		- #### riassumendo:
			- $$D_{xy}^{k}=min\{D_{xk}^{k-1},D_{ky}^{k-1}, D_{xy}^{k-1}\}$$
	- ![[FloydWarshall ottimizzato.png]]
		- ### Costo: 
			- tempo: $O(n^{3})$,  spazio: $O(n^{2})$
		- ### Riassunto:
			- nella matrice delle distanze di ogni coppia di nodi associa il valore 0 se si parla dello stesso nodo, se sono nodi adiacenti ci associa il peso dell'arco e il campo next viene aggiornato col nodo di destinazione, in tutti gli altri casi $+\infty$ finita l'inizializzazione procede a controllare se, utilizzando un terzo nodo _k_, la distanza tra i nodi _x,y_ diminuisce, in tal caso modifica la distanza nella matrice _D_  e aggiorna il campo next del nodo di partenza con il nodo intermedio _k_ infine restituisce la matrice delle distanze _D_. 
	- ### Stampa dei cammini:
		- Al termine dell'algoritmo la procedura seguente stampa i nodi del cammino di costo minimo che va dal nodo _u_ al nodo _v_ in ordine di attraversamento:
			- ![[Stampa cammini.png]]
	- Dopo aver riempito la tabella con il costo per ogni coppia di nodi nel grafo bisogna costruire una tabella che rappresenta gli effettivi cammini da percorrere.
		- si può usare una matrice di _successori next$[x,y]$_ di n x n 
			- next$[x,y]$: nelle colonne sono rappresentate le sequenze di passaggio da un vertice all'altro, -1 rappresenta il non poter arrivare ad un nodo attraverso un altro:
				- ![[tabella Floyd-Warshall.png]]
	- L'algoritmo può anche essere usato per individuare i cicli negativi, infatti quando termina l'algoritmo viene verificata la loro esistenza.
	- ### Individuare cicli negativi.
		- al termine dell'algoritmo se la distanza di un nodo da se stesso è minore di 0 allora vuol dire che quel nodo fa parte di un ciclo negativo.